# ЛР 4. Python + Airflow, оркестрация данных

## Цель лабораторной работы

Реализовать систему обновления данных посредствам системы-оркестрации Airflow

## Требования лабораторной работы

- Создан даг, который осуществляется инициализацию вашей схемы внутри метабазы данных Airflow(таблицы, функции)
- Создан даг, который осуществляет загрузку данных в вашу таблицу
- Создан даг, который осуществляет расчет метрик согласно заданию
- После выполнения расчета, в вашей созданной таблице для метрик, можно ознакомиться с показателями.

## Пример изменений в PR
Изменения ваши оказываются в таком пути students_folder/surname/lab5/airflow_folder/
В папке добавляются 3 python файла
- **/dags/init_schema.py
- **/dags/init_data.py
- **/dags/collect_data.py

### Вариант 1
**Условия:** Ваша компания занимается авиаперевозками. Ваши основные данные находятся в таблице 
_logistic.transfers_ (id BIGINT, from TEXT, to TEXT, departure_date DATE, arriving_date).
Вам нужно вывести общее количество отправленных рейсов на каждый день.

### Вариант 2
**Условия:** У вас есть интернет-магазин. Данные о продажах хранятся в таблице
_market.sales_ (id BIGINT, product_name TEXT, sale_date DATE, amount DECIMAL).
Вам нужно вывести общую сумму продаж за каждый день.

### Вариант 3
**Условия:** Вы работаете в HR-отделе компании. Информация о сотрудниках находится в таблице
_company.employees_ (id BIGINT, name TEXT, department TEXT, hire_date DATE).
Вам нужно определить, сколько новых сотрудников было принято на работу в каждый месяц (в формате YYYY-MM).


### Вариант 4
**Условия**: В медицинской клинике ведётся журнал визитов пациентов. Данные хранятся в таблице
_hospital.visits_ (visit_id BIGINT, patient_id BIGINT, doctor_id BIGINT, visit_date DATE, diagnosis TEXT).
Вам нужно найти все даты, в которые было зафиксировано ровно 5 визитов.


### Вариант 5
**Условия:** Образовательная онлайн-платформа отслеживает завершение курсов. Данные находятся в таблице
_ed_tech.course_completions_ (user_id BIGINT, course_name TEXT, completion_date DATE).
Вам нужно посчитать количество уникальных пользователей, завершивших хотя бы один курс, по каждому дню.

### Вариант 6
**Условия:** Компания занимается доставкой товаров. История изменений статусов заказов хранится в таблице
_logistics.deliveries_ (order_id BIGINT, status TEXT, update_date DATE).
Вам нужно вывести количество заказов, получивших статус 'delivered', за каждый день.
